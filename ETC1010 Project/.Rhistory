knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
vis_dat(all)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
m <- ggmap(vic) +
geom_point(data=loc_2018, aes(x=lon, y=lat,label = values),
alpha=1, colour='red', size=0.5)
ggplotly(m)
View(loc_2018)
m <- ggmap(vic) +
geom_point(data=loc_2018, aes(x=lon, y=lat,label = values,label = LGA),
alpha=1, colour='red', size=0.5)
ggplotly(m)
View(loc_2018)
View(all_medianp_2018)
View(all_medianp)
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
m <- ggmap(vic) +
geom_point(data=loc_2018, aes(x=lon, y=lat,label = values),
alpha=1, colour='red', size=0.5)
ggplotly(m)
agegroup_2017 <- read_xls("data/2017.xls",sheet = "Table 3")
agegroup_2017<-agegroup_2017[-c(1:8),-c(1)]
agegroup_2017<-agegroup_2017[,-c(2:6)]
agegroup_2017<-agegroup_2017[,-c(3:4)]
agegroup_2017<-agegroup_2017 %>%
select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21)) %>%
filter(state=="Victoria")
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(gdp_plot)
# compute the eco growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
#historical gdp plot
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(gdp_plot)
# compute the gdp growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
View(all)
View(all_counts)
View(all_f)
medianrentcts <- all_medianp %>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
medianrentcts <- all_medianp %>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
View(medianrentcts_plot)
medianrentcts <- all_counts%>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
all_counts_mod <- all_counts %>%
filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_counts_mod <- all_counts %>%
filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
medianrentcts <- all_counts%>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
all_counts_mod <- all_counts %>%
filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
medianrentcts <- all_counts_mod%>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
all_counts_mod <- all_counts %>%
filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria',Suburb != 'Melbourne')
medianrentcts <- all_counts_mod%>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentcts_plot)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
# compute the distance from LGA to Melbourne city, and see if there is anything to do with rental price.
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
distance <- distance[,c(2,9)]
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]
all_medianp$Suburb[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point()
ggplotly(dis)
View(dis_price_join)
View(all_medianp_avg)
View(all_medianp)
View(gdp_slope)
all_median_avg_yr <- aggregate(all_medianp[,5],list(all_medianp$year),mean)
View(all_median_avg_yr)
all_median_avg_yr <- aggregate(all_medianp[,5],list(c(all_medianp$Suburb,all_medianp$year),mean)
all_median_avg_yr <- aggregate(all_medianp[,5],list(c(all_medianp$Suburb,all_medianp$year),mean)
all_median_avg_yr <- aggregate(all_medianp[,5],list(all_medianp$year),mean)
all_median_avg_yr <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
?aggregate
all_median_avg_yr <- all_medianp %>% group_by(Suburb) %>% aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
all_median_avg_yr <- all_medianp %>% group_by(Suburb)
all_median_avg_yr <- all_medianp %>% group_by(c(Suburb,year)) $>$ mutate(avg = mean(values))
all_median_avg_yr <- all_medianp %>% group_by(c(Suburb,year)) %>% mutate(avg = mean(values))
all_median_avg_yr <- all_medianp %>% group_by(Suburb) %>% group_by(year) %>% mutate(avg = mean(values))
all_median_avg_yr <- all_medianp %>% group_by(Suburb) %>% mutate(avg = mean(values))
all_median_avg_yr <- all_medianp %>% group_by(Suburb) %>% mutate(avg = mean(values))
View(LGA_mod)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
?apply
all_median_avg_yr <- apply(all_medianp[all_medianp$Suburb == 'Alpine'],mean)
all_median_avg_yr <- apply(all_medianp[all_medianp$Suburb == 'Alpine'],2,mean)
all_median_avg_yr <- apply(all_medianp,2,mean)
all_median_avg_yr <- apply(all_medianp,1,mean)
all_median_avg_yr <- apply(all_medianp[all_medianp$Suburb = 'Alpine'],1,mean)
all_median_avg_yr <- apply(all_medianp[all_medianp$Suburb == 'Alpine'],1,mean)
all_median_avg_yr <- apply(all_medianp[all_medianp$Suburb == 'Alpine'],2,mean)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
vis_dat(all)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
m <- ggmap(vic) +
geom_point(data=loc_2018, aes(x=lon, y=lat,label = values),
alpha=1, colour='red', size=0.5)
ggplotly(m)
View(all_counts_mod)
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()+ytitle("count")
?ytitle
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()+ylab("count")
ggplotly(medianrentcts_plot)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
#historical gdp plot
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line() + ggtitle("Australian Historical GDP")
ggplotly(gdp_plot)
# compute the gdp growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line() + ggtitle("Australian Historical Economic Growth Rate ")
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point() + ylab("Median Rental Price")
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point() + ylab("Median Rental Price")
# compute the distance from LGA to Melbourne city, and see if there is anything to do with rental price.
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
distance <- distance[,c(2,9)]
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]
all_medianp$Suburb[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point() + ylab("Median Rental Price")
ggplotly(dis)
library(flexdashboard)
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
#tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=7)
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=7)
m <- ggmap(vic) +
geom_point(data=loc_2018, aes(x=lon, y=lat,label = values),
alpha=1, colour='red', size=0.5)
ggplotly(m)
library(flexdashboard)
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
# vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
# m <- ggmap(vic) +
#   geom_point(data=loc_2018, aes(x=lon, y=lat,label = values),
#               alpha=1, colour='red', size=0.5)
# ggplotly(m)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
#historical gdp plot
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line() + ggtitle("Australian Historical GDP")
ggplotly(gdp_plot)
# compute the gdp growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line() + ggtitle("Australian Historical Economic Growth Rate ")
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
# compute the distance from LGA to Melbourne city, and see if there is anything to do with rental price.
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
distance <- distance[,c(2,9)]
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]
all_medianp$Suburb[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point() + ylab("Median Rental Price")
ggplotly(dis)
all_counts_mod <- all_counts %>%
filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria',Suburb != 'Melbourne')
medianrentcts <- all_counts_mod%>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()+ylab("count")
ggplotly(medianrentcts_plot)
