mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
medianrentps_plot <- medianrentps %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentps_plot)
#medianrentps <- medianrentps %>% filter(Suburb=="Bayside")
#identify regression trees. this will help to identify regions of similar trend
medianrentps_rp <- rpart(values~date,data=medianrentps,control=rpart.control(minsplit=3))
medianrentps_pred <- medianrentps %>% mutate(pred=predict(medianrentps_rp,medianrentps))
medianrentps_rp_plot <- ggplot(medianrentps_pred) + geom_point(aes(x=date,y=values)) + geom_line(aes(x=date,y=pred),colour="orange",size=1.5)
ggplotly(medianrentps_rp_plot)
#applying a regression tree allows us to identify different partitions in the data. there final partition and most relevant (as it is closest to present time) begins in 01-Jun-2011. This is convenient, as the ABS has begun collecting specific regional data on LGAs beginning
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=9)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
vis_dat(all)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
#LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=9)
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
#LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
ggplotly(m)
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=7)
ggplotly(m)
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=7)
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
ggplotly(m)
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
View(medianrentps)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("GDP.csv")
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
View(gdp)
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(medianrentps_plot)
ggplotly(gdp_plot)
m1 <- lm(gdp$Value~gdp$TIME)
resid(m1)
plot(density(resid(m1)))
resid(m1)
View(m1)
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = 0))
View(gdp_slope)
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = 1))
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = 1))
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = 0))
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp %>% mutate(rate = Value - lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggploty(rate_plot)
ggplotly(rate_plot)
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp %>% mutate(rate = volume / lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
library(regex)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
library(regex)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
#LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(gdp_plot)
medianrentps <- all_medianp %>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
View(medianrentp)
# compute the eco growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
View(medianrentp)
medianrentps <- all_medianp %>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
View(medianrentp)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
lganames <- read.dbf("data/VIC_LGA_POLYGON_shp.dbf")
lgapoly <- readShapePoly("data/VIC_LGA_POLYGON_shp.shp")
library(RColorBrewer)
colors <- brewer.pal(9, "BuGn")
lgapoly.points <- fortify(lgapoly)
lgamap <- get_map(location = c(lon = 144.7852, lat = -37.4713), zoom=6)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
vis_dat(all)
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
#LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]
LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]
#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))
# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(gdp_plot)
medianrentps <- all_medianp %>%
mutate(date=paste("01-",month,"-",year)) %>%
mutate(date=dmy(date)) %>%
select("Suburb","values","date") %>%
mutate(values=as.numeric(values))
# compute the eco growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
View(medianrentps)
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line()
ggplotly(gdp_plot)
# compute the eco growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line()
ggplotly(rate_plot)
#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
View(distance)
distacne <- distance[,c(2,9)]
distacne <- distance[,c(2,9)]
distance <- distance[,c(2,9)]
View(distance)
distance$LGA <- trim.trailing(distance$LGA)
distance$LGA <- trim.trailing(distance$LGA)
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]
View(all_medianp)
all_medianp_avg <- all_medianp %>% group_by(Suburb) %>% mutate(average = mean(values))
View(all_medianp_avg)
aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
?as.integer()
all_medianp[,5] <- as.integer(all_medianp[,5])
as.integer(all_medianp[,5])
all_medianp <- as.numeric(all_medianp$values)
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"
vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)
colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]
all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")
vis_dat(all)
all_medianp$values <- as.numeric(all_medianp$values)
aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
all_medianp$values <- as.integer(all_medianp$values)
aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
impute(all_medianp$values,mean)
library(Hmisc)
impute(all_medianp$values,mean)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
View(dis_price_join)
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]
LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=8)
library(impute)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
library(impute)
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
distance <- distance[,c(2,9)]
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
View(all_medianp)
library(learnr)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE,
collapse = TRUE,
fig.height = 6,
fig.width = 6,
fig.align = "center",
cache = FALSE)
tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
library(rpart)
library(rpart.plot)
all_medianp[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp$Suburb[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total',Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total')
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')
View(dis_price_join)
ggplot(dis_price_join,aes(x=distance,y=price)) + geom_point()
ggplot(dis_price_join,aes(x=distance,y=values)) + geom_point()
ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point()
ggplotly(dis)
dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point()
ggplotly(dis)
