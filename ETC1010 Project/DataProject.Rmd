---
title: "Project Data Cleaning"
output:
  html_document:
    df_print: paged
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,   
                      message = FALSE,
                      warning = FALSE,
                      collapse = TRUE,
                      fig.height = 6,
                      fig.width = 6,
                      fig.align = "center",
                      cache = FALSE)
#tutorial_html_dependency()
library(tidyverse)
library(plotly)
library(readxl)
library(visdat)
library(foreign)
library(maptools)
library(ggmap)
library(plyr)
library(lubridate)
```

```{r eval = FALSE}
lganames <- read.dbf("data/VIC_LGA_POLYGON_shp.dbf")
lgapoly <- readShapePoly("data/VIC_LGA_POLYGON_shp.shp")

library(RColorBrewer)
colors <- brewer.pal(9, "BuGn")

lgapoly.points <- fortify(lgapoly)
lgamap <- get_map(location = c(lon = 144.7852, lat = -37.4713), zoom=6)
ggmap(lgamap) +
  geom_polygon(aes(x = long,
      y = lat,
      group = group),
    data = lgapoly.points,
    color = colors[9],
    fill = colors[6],
    alpha = 0.5) +
labs(x = "Longitude",
  y = "Latitude")
#oz <- get_map(location=c(lon=133.8807,lat=-23.6980),zoom=4)
```


```{r echo=FALSE}
all <- read_xlsx("data/Quarterly median rents by local government area - March quarter 2018.xlsx",sheet = 7)
head(all)
all <- all[,-1]
#all <- all %>% rename("Suburb" = "X__2")
colnames(all)[1] <- "Suburb"

vec1 <- seq(2,ncol(all),2)
vec2 <- seq(3,ncol(all),2)

colnames(all)[vec2] <- colnames(all)[vec1]
colnames(all)[vec1] <- paste(colnames(all)[vec2],"_Count",sep='')
colnames(all)[vec2] <- paste(colnames(all)[vec2],"_Median",sep='')
all <- all[-c(1,90),]

all_f <- all %>% gather(variable, values, -Suburb) %>% arrange(Suburb)
all_f <- all_f %>% separate(variable, c("month","year","type"),by="_")
all_medianp <- all_f %>% filter(type == "Median")
all_counts <- all_f %>% filter(type == "Count")

vis_dat(all)
```

<<<<<<< HEAD
```{r}
=======
```{r echo=FALSE,"Hongrui's section1"}
>>>>>>> 8de5d5320341600c7a17a91289d07ff9581e745d
# to retrieve the average lat and lon from the files
LGACouncil <- read_csv("data/fileslocalgovt.csv")
LatLon <- read_csv("data/Australian_Post_Codes_Lat_Lon 2.csv")
LatLon <- LatLon[,c(1,2,3,6,7)]


LatLon <- LatLon %>% filter(state == 'VIC')
LatLon <- LatLon %>% mutate(Postcode = postcode)
LatLon <- LatLon[,c(6,2,4,5)]
LGACouncil <- LGACouncil[,c(1,4,7)]

#match the coordinate with the LGA
LGAjoin <- left_join(LGACouncil,LatLon, by='Postcode')
LGA_mod <- LGAjoin %>% group_by(Name) %>% mutate(avg_lat = mean(lat),avg_lon = mean(lon))
LGA <- LGAjoin[!duplicated(LGA_mod$LGA),]
LGA <- LGA[,-c(1,4)]
LGA <- LGA[,c(2,1,3,4)]
LGA <- LGA %>% separate(LGA,sep="[(]",c("LGA","Index"))

# remove trailing whitespace
trim.trailing <- function (x) sub("\\s+$", "", x)
LGA$LGA <- trim.trailing(LGA$LGA)
LGA <- LGA[,-2]
```

<<<<<<< HEAD
```{r eval = FALSE}
=======
```{r echo = FALSE, eval=FALSE ,"Hongrui's section2"}
#plot the LGA in the map of victoria alongsied with its median price in 2018 Mar
>>>>>>> 8de5d5320341600c7a17a91289d07ff9581e745d
all_medianp_2018 <- all_medianp %>% filter(year == 2018)
all_medianp_2018 <- all_medianp_2018 %>% mutate(LGA = Suburb)
all_medianp_2018 <- all_medianp_2018[,c(6,2,3,4,5)]

LGA <- LGA %>% arrange(LGA)
all_medianp_2018 <- all_medianp_2018 %>% arrange(LGA)
loc_2018 <- right_join(LGA,all_medianp_2018,by='LGA')

<<<<<<< HEAD
loc_2018 <- loc_2018 %>% filter(LGA != 'Group Total' & LGA != 'Metro' & LGA != 'Non-Metro' & LGA != 'Victoria')
loc_2018$LGA[loc_2018$LGA  == 'Mornington Penin\'a'] <- "Mornington Peninsula"

vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=9)
=======
vic <- get_map(location=c(lon=144.9460, lat=-37.8150), zoom=7)
>>>>>>> 8de5d5320341600c7a17a91289d07ff9581e745d
m <- ggmap(vic) + 
  geom_point(data=loc_2018, aes(x=lon, y=lat,label = values), 
              alpha=1, colour='red', size=0.5)
ggplotly(m)
```

```{r}
testvar <- all_medianp %>%  
  mutate(date=paste("01-",month,"-",year)) %>% 
  mutate(date=dmy(date)) %>% 
  select("Suburb","values","date") %>%
  mutate(values=as.numeric(values))
#glimpse(testvar)
ticks<-c(100,200,300,400,500,600)
testgraph <- testvar %>% ggplot(aes(x=date,y=values,colour=Suburb,yaxt="n"))+geom_line() #geom_smooth(se=FALSE)#+geom_point()+geom_smooth(se=FALSE)#+scale_y_discrete(limits=600)

ggplotly(testgraph)
```



```{r echo=FALSE}
agegroup_2017 <- read_xls("data/2017.xls",sheet = "Table 3") 
agegroup_2017<-agegroup_2017[-c(1:8),-c(1)]
agegroup_2017<-agegroup_2017[,-c(2:6)]
agegroup_2017<-agegroup_2017[,-c(3:4)] 
agegroup_2017<-agegroup_2017 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'pop'=c(21)) %>%
  filter(state=="Victoria")
```

```{r echo=FALSE} 
agegroup_2016 <- read_xls("data/2006_2016.xls",sheet = "Table 6") 
agegroup_2016<-agegroup_2016[-c(1:8),-c(1)]
agegroup_2016<-agegroup_2016[,-c(2:6)]
agegroup_2016<-agegroup_2016[,-c(3:4)]
agegroup_2016<-agegroup_2016 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2006 <- read_xls("data/2006_2016.xls",sheet = "Table 3") 
agegroup_2006<-agegroup_2006[-c(1:8),-c(1)]
agegroup_2006<-agegroup_2006[,-c(2:6)]
agegroup_2006<-agegroup_2006[,-c(3:4)]
agegroup_2006<-agegroup_2006 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2015 <- read_xls("data/2010_2015.xls",sheet = "Table 6") 
agegroup_2015<-agegroup_2015[-c(1:7),-c(1)]
agegroup_2015<-agegroup_2015[,-c(2:6)]
agegroup_2015<-agegroup_2015[,-c(3:4)]
agegroup_2015<-agegroup_2015 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2010 <- read_xls("data/2010_2015.xls",sheet = "Table 3") 
agegroup_2010<-agegroup_2010[-c(1:7),-c(1)]
agegroup_2010<-agegroup_2010[,-c(2:6)]
agegroup_2010<-agegroup_2010[,-c(3:4)]
agegroup_2010<-agegroup_2010 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2014 <- read_xls("data/2009_2014.xls",sheet = "Table 6") 
agegroup_2014<-agegroup_2014[-c(1:8),-c(1)]
agegroup_2014<-agegroup_2014[,-c(2:6)]
agegroup_2014<-agegroup_2014[,-c(3:4)]
agegroup_2014<-agegroup_2014 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2009 <- read_xls("data/2009_2014.xls",sheet = "Table 3") 
agegroup_2009<-agegroup_2009[-c(1:8),-c(1)]
agegroup_2009<-agegroup_2009[,-c(2:6)]
agegroup_2009<-agegroup_2009[,-c(3:4)]
agegroup_2009<-agegroup_2009 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2013<- read_xls("data/2008_2013.xls",sheet = "Table 6") 
agegroup_2013<-agegroup_2013[-c(1:8),-c(1)]
agegroup_2013<-agegroup_2013[,-c(2:6)]
agegroup_2013<-agegroup_2013[,-c(3:4)]
agegroup_2013<-agegroup_2013 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2008 <- read_xls("data/2008_2013.xls",sheet = "Table 3") 
agegroup_2008<-agegroup_2008[-c(1:8),-c(1)]
agegroup_2008<-agegroup_2008[,-c(2:6)]
agegroup_2008<-agegroup_2008[,-c(3:4)]
agegroup_2008<-agegroup_2008 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2012 <- read_xls("data/2011_2012.xls",sheet = "Table 6") 
agegroup_2012<-agegroup_2012[-c(1:8),-c(1)]
agegroup_2012<-agegroup_2012[,-c(2:6)]
agegroup_2012<-agegroup_2012[,-c(3:4)]
agegroup_2012<-agegroup_2012 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2011 <- read_xls("data/2011_2012.xls",sheet = "Table 3") 
agegroup_2011<-agegroup_2011[-c(1:8),-c(1)]
agegroup_2011<-agegroup_2011[,-c(2:6)]
agegroup_2011<-agegroup_2011[,-c(3:4)]
agegroup_2011<-agegroup_2011 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2014 <- read_xls("data/2009_2014.xls",sheet = "Table 6") 
agegroup_2014<-agegroup_2014[-c(1:8),-c(1)]
agegroup_2014<-agegroup_2014[,-c(2:6)]
agegroup_2014<-agegroup_2014[,-c(3:4)]
agegroup_2014<-agegroup_2014 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```

```{r echo=FALSE}
agegroup_2007 <- read_xls("data/2007.xls",sheet = "Table 3") 
agegroup_2007<-agegroup_2007[-c(1:8),-c(1)]
agegroup_2007<-agegroup_2007[,-c(2:6)]
agegroup_2007<-agegroup_2007[,-c(3:4)]
agegroup_2007<-agegroup_2007 %>%
  select('state'=c(1),'LGA'=c(2),'0-4'=c(3),'5-9'=c(4),'10-14'=c(5),'15-19'=c(6),'20-24'=c(7),'25-29'=c(8),'30-34'=c(9),'35-39'=c(10),'40-44'=c(11),'45-49'=c(12),'50-54'=c(13),'55-59'=c(14),'60-64'=c(15),'65-69'=c(16),'70-74'=c(17),'75-79'=c(18),'80-84'=c(19),'85 and over'=c(20),'total persons'=c(21))
```


```{r echo=FALSE}
abslgadata1 <- read_csv("data/ABS_REGIONAL_LGA2017-enp1.csv")
abslgadata2 <- read_csv("data/ABS_REGIONAL_LGA2017-enp2.csv")
abslgadata <- rbind(abslgadata1,abslgadata2) %>% select(-MEASURE,-REGIONTYPE,-`Geography Level`,-LGA_2017,-FREQUENCY,-Frequency,-TIME,-`Flag Codes`,-Flags)
#unique(abslgadata$`Data item`) #Shows unique data items within abslgadata
#unique(abslgadata$Region) #Shows unique LGAs within abslgadata
glimpse(abslgadata)
```

<<<<<<< HEAD
```{r}
pop_2017<-agegroup_2017 %>%
  mutate(pop = as.numeric(pop)) %>%
  group_by(LGA) %>%
  dplyr::summarise(pop = sum(pop, na.rm = TRUE))
ggplot(pop_2017, aes(x=pop, y=LGA)) +geom_point()
```
#plot the population distribution in a map
```{r}
popdis_2017<-full_join(pop_2017, LGA, by=c("LGA"="LGA")) %>%
  filter(!is.na(lat), !is.na(lon), !is.na(pop))
lgamap <- get_map(location = c(lon = 144.7852, lat = -37.4713), zoom=6)
ggmap(lgamap) +geom_point(popdis_2017, aes(x=lon,y=lat,colour=pop), size=4, alpha=0.7)+
  scale_colour_distiller(palette="YlOrRd")
```


#plot the rental prices distribution in a map
```{r}
rent2017<-filter(all_medianp, year=="2017") %>%
  mutate(values=as.numeric(values), Suburb=as.factor(Suburb)) %>%
  group_by(Suburb) %>% dplyr::summarise(n = mean(values, na.rm = TRUE))
left_join(rent2017, LGA, by=c("Suburb"="LGA")) %>%
  select(Suburb, n, lat, lon) %>%
  filter(!is.na(lat),!is.na(lon))
lgamap <- get_map(location=c(144.9631, -37.8136), zoom=14)
ggmap(lgamap) +geom_point(aes(x=lat,y=lon,colour=n), size=4, alpha=0.7)+
  scale_colour_distiller(palette="YlOrRd")
rent2017
=======

```{r echo=FALSE,"kevan's section"}
#tidy data into usable form, keeping suburb, values and date
medianrentps <- all_medianp %>%  
  mutate(date=paste("01-",month,"-",year)) %>% 
  mutate(date=dmy(date)) %>% 
  select("Suburb","values","date") %>%
  mutate(values=as.numeric(values))
medianrentps_plot <- medianrentps %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()
ggplotly(medianrentps_plot)
```

```{r echo=FALSE, "kevan's section 2"}
#medianrentps <- medianrentps %>% filter(Suburb=="Bayside")
#identify regression trees. this will help to identify regions of similar trend
medianrentps_rp <- rpart(values~date,data=medianrentps,control=rpart.control(minsplit=3))
medianrentps_pred <- medianrentps %>% mutate(pred=predict(medianrentps_rp,medianrentps))
medianrentps_rp_plot <- ggplot(medianrentps_pred) + geom_point(aes(x=date,y=values)) + geom_line(aes(x=date,y=pred),colour="orange",size=1.5)
ggplotly(medianrentps_rp_plot)
#applying a regression tree allows us to identify different partitions in the data. there final partition and most relevant (as it is closest to present time) begins in 01-Jun-2011. This is convenient, as the ABS has begun collecting specific regional data on LGAs beginning
```

```{r echo=FALSE, "kevan's section 3"}
#the types of data given by the ABS regional data is numerous.
#as_tibble(unique(absviclgadata$`Data item`))
#this shows that there are a total of 398 different data items! majority of this data is collected annually, however some of these data items have missing data items
absviclgadata_spreadbyyear <- absviclgadata %>% spread(key=Time,value=Value)
vis_dat(absviclgadata_spreadbyyear,warn_large_data=FALSE)
#we notice that there is a significant amount of missing data, notably in 2017. We wish to use data points with at least 6 points of data, i.e. 2011-2016. 2017 is a bonus!
```
```{r echo=FALSE, "Kevan's section 3"}
#we then remove the data that has less than 6 data points and see what information we're left with. we do not wish to impute the missing values as it may be making the incorrect assumption that the change of all these data items are related to each other per LGA. 
absviclgadata_countyears <- absviclgadata %>% group_by(`Data item`,Region) %>% dplyr::summarise(no_years = sum(!is.na(Time))) 
nodataitems_g7 <- absviclgadata_countyears %>% filter(no_years>=7) %>% nrow()
nodataitems_g6 <- absviclgadata_countyears %>% filter(no_years>=6) %>% nrow()
nodataitems <- absviclgadata_countyears %>% nrow()
as.tibble(list(Name=c("No. of data items with more than 7 years of data","No. of data items with more than 6 years of data","Total number of data items"),Count=c(nodataitems_g7,nodataitems_g6,nodataitems),Percentage=c(nodataitems_g7/nodataitems,nodataitems_g6/nodataitems,nodataitems/nodataitems)))
#this tells us that there is only 2569 of 22268 data items that have 6 more more points of data. that's only about 11.54% of all data points! Even worse, only 2.4% of the data items actually have all 7 years of data! it would be possible to impute the missing values for data items with 2 or more values, however it would not be extremely accurate. Let's try and do some analysis without imputing.

#first, lets find out what kind of information we have left, and how many lgas in each one.
absviclgadata_unique_g6 <- absviclgadata_countyears %>% filter(no_years == 6) %>% group_by(`Data item`) %>% dplyr::summarise(lga_count = n())
absviclgadata_unique_g6
#this has left us with only 40 actual different data points, when we started with 295!! 
absviclgadata_unique_g6 %>% filter(lga_count > 20)
#of these 40, it must be noted that only 18 of these data items have over 300 points of data. Of these, majority of them are actually vehicle statistics. maybe this analysis should be on whether the number of vehicles in the area have a significant effect on rental price
```

```{r echo=FALSE}
#lets do that! it must be noted that although 6 points of data for each LGA does not provide very reliable information, however expanding this to over 500 different LGAs can provide a reasonable conclusion if there is a significant pattern between all of them.
mvcdata <- absviclgadata %>% dplyr::filter(grepl("MVC",MEASURE)) %>% select(-MEASURE)
#lets look at a sample of the data for one LGA, and plot it against its median rental price
mvcdata <- mvcdata %>% mutate(Time=dmy(paste("31-12-",Time)))

l <- ggplot(mvcdata,aes(x=Time,y=Value,colour=Region))+geom_line()+facet_wrap(~`Data item`)
ggplotly(l)
>>>>>>> 8de5d5320341600c7a17a91289d07ff9581e745d
```
#combine the population and rental prices distribution 


  



<<<<<<< HEAD
=======
```{r echo=FALSE,"Hongrui's section3"}
#look at historical rental price reacted to the Australian economy
gdp <- read_csv("data/GDP.csv")
gdp <- gdp %>% filter(LOCATION == "AUS")
gdp <- gdp[,c(1,6,7)]
#historical gdp plot
gdp_plot <- gdp %>% ggplot(aes(x=TIME,y=Value))+geom_line() + ggtitle("Australian Historical GDP")
ggplotly(gdp_plot)

# compute the gdp growth rate
gdp_slope <- gdp %>% mutate(volume = Value - lag(Value, default = Value[1]))
gdp_slope <- gdp_slope %>% mutate(rate = volume / lag(Value, default = Value[1]))
rate_plot <- gdp_slope %>% ggplot(aes(x=TIME,y=rate))+geom_line() + ggtitle("Australian Historical Economic Growth Rate ")
ggplotly(rate_plot)

#as we can see, when there is a decrease on economics growth, there will be a boost on rental price, referring to Kevon's medianrentps_plot, as it's shown in year 2007 - 2008, and 2011 - 2012
```
```{r echo=FALSE,"Hongrui's section4"}
# compute the distance from LGA to Melbourne city, and see if there is anything to do with rental price.
distance <- read_csv("data/LGA_Profile_2014_beta.csv")
distance <- distance[,c(2,9)]
distance <- distance %>% separate(LGA,sep="[(]",c("LGA","Index"))
trim.trailing <- function (x) sub("\\s+$", "", x)
distance$LGA <- trim.trailing(distance$LGA)
distance <- distance[,-2]

all_medianp$Suburb[all_medianp$Suburb == 'Mornington Penin\'a'] <- 'Mornington Peninsula'
all_medianp <- all_medianp %>% filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria')
all_medianp$values <- as.integer(all_medianp$values)
all_medianp$values[is.na(all_medianp$values)] <- mean(all_medianp$values, na.rm = T)
all_medianp_avg <- aggregate(all_medianp[,5],list(all_medianp$Suburb),mean)
colnames(all_medianp_avg)[1] <- 'LGA'
dis_price_join <- left_join(all_medianp_avg,distance,by='LGA')

dis <- ggplot(dis_price_join,aes(x=Distance_to_Melbourne_in_km,y=values)) + geom_point() + ylab("Median Rental Price")
ggplotly(dis)
```
```{r echo=FALSE,"Hongrui's seciton5"}
>>>>>>> 8de5d5320341600c7a17a91289d07ff9581e745d

all_counts_mod <- all_counts %>%
  filter(Suburb != 'Metro',Suburb != 'Non-Metro', Suburb != 'Group Total', Suburb != 'Victoria',Suburb != 'Melbourne')
medianrentcts <- all_counts_mod%>%  
  mutate(date=paste("01-",month,"-",year)) %>% 
  mutate(date=dmy(date)) %>% 
  select("Suburb","values","date") %>%
  mutate(values=as.numeric(values))
medianrentcts_plot <- medianrentcts %>% ggplot(aes(x=date,y=values,colour=Suburb))+geom_line()+ylab("count")
ggplotly(medianrentcts_plot)
```

#Hongrui's analysis:
The analysis carried out was aimed to look at if the economic condition would have an impact on rental price in victoria, and effect of the distance from the local area to Melbourne CBD to the rental price. The GFC started in 2007 along to 2008 was taken as an example, and we can notice there was downward pressure on Australian economic growth starting from 2006 to 2008. This situation was reflected in the plots of historical median rental price and count of 79 LGAs among Vcitoria, where there was a boost on the rental price. The median rental price started to climb from the beginning of 2007, which could be resulted from the desire of cash by the property owners during the low tide of the economy. As for the median count of the leased properties, we can notice there was a decrease on rental properties at the beginnig of 2007, followed by a continuously growing amout. It could be resulted from the government's low interest rate and expansionary budget which encouraged people to consume instead of putting money into the bank, and this could explain why the median count started to pick up in mid 2007 and reached a peak in 2008 where meanwihle the rental price was continuously growing. Looking at the plot, we can notice there's a negative relationship between the distance to CBD and the rental price for a certain LGA, as the CBD is meant to be the financial and economic centre, where people mostly work in. Therefore, people would desire to live closer to CBD, and the over-demanded rental properties and limited developing residential area lead to a high rental price in CBD and areas arond it. 





=======
get_distance = read_csv('data/LGA_Profile_2014_beta.csv')
get_distance <- get_distance[,c(2,9)]
get_distance <- get_distance %>% separate(LGA, sep = "[()]",c("LGA","index"))

get_distance$LGA <- trim.trailing(get_distance$LGA)
get_distance <- get_distance[,-2]
glimpse(get_distance)

loc_2018_added_dis <- left_join(loc_2018,get_distance,by = "LGA")

p <- ggplot(loc_2018_added_dis, aes(x=Distance_to_Melbourne_in_km, y=values,label = LGA)) + geom_point() + ylab("Rental Price") + ggtitle("Price changed by distance to Melbourne CBD in 2018")

ggplotly(p)
>>>>>>> eef71a3b2db5e21cfbd82bb67a8d2617180af088
```

